<html>
<head>


<title>Iggys Final Project Test </title>

<font style="font-size:30px">



<script type="text/javascript">
<!--
var loadingmessage = 'Processing...';
function setAjax(){
   var xmlHttp;
   try{
      xmlHttp=new XMLHttpRequest(); // Firefox, Opera 8.0+, Safari
      return xmlHttp;
   }
   catch (e){
      try{
         xmlHttp=new ActiveXObject("Msxml2.XMLHTTP"); // Internet Explorer
         return xmlHttp;
      }
      catch (e){
         try{
            xmlHttp=new ActiveXObject("Microsoft.XMLHTTP");
            return xmlHttp;
         }
         catch (e){
            alert("Your browser does not support AJAX!");
            return false;
         }
     }
   }
}



function myAjax(f, url, myDivToChange) {
   var poststr = getFormValues(f);
    postData(url, poststr, myDivToChange);
}



function postData(url, parameters, myDivToChange2){
   var xmlHttp = setAjax();
   xmlHttp.onreadystatechange =  function(){
      if(xmlHttp.readyState > 0 && xmlHttp.readyState < 4){
          document.getElementById(myDivToChange2).innerHTML=loadingmessage;
      }
      if (xmlHttp.readyState == 4) {
             // this is where the magic occcurs
             
          var myJsonObject = JSON.parse(xmlHttp.responseText);
             
             
           //document.getElementById(myDivToChange2).innerHTML=xmlHttp.responseText+' data sent was '+parameters;
         
           document.getElementById(myDivToChange2).innerHTML= myJsonObject.return_value;
         
         
         
      }
   }
   xmlHttp.open("POST", url, true);
   xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
   xmlHttp.send(parameters);
}




function getFormValues(fobj){
   var str = "";
   var valueArr = null;
   var val = "";
   var cmd = "";
   for(var i = 0;i < fobj.elements.length;i++){
      switch(fobj.elements[i].type){
         case "text":
            str += fobj.elements[i].name +"=" + escape(fobj.elements[i].value) + "&";
            break;         
         case "password":
            str += fobj.elements[i].name +"=" + escape(fobj.elements[i].value) + "&";
            break;
         case "textarea":
            str += fobj.elements[i].name +"=" + escape(fobj.elements[i].value) + "&";
            break;
         case "select-one":
             str += fobj.elements[i].name +"=" + fobj.elements[i].options[fobj.elements[i].selectedIndex].value + "&";
             break;
     }
   }
   str = str.substr(0,(str.length - 1));
   return str;
}




function sendToSpark(myIn){
    document.all.myParameter.value = myIn
    document.myForm.action = 'https://api.spark.io/v1/devices/' + document.all.myDeviceId.value + '/' + document.all.myFunctionName.value
    myAjax(document.all.myCoolForm, document.myForm.action, 'myDivId')   
    
}



//--></script>











<h1 align=center>

<input type="button" value="D7 on" onClick="{
    sendToSpark('d7-send-1')
}">
<input type="button" value="D7 off" onClick="{
    sendToSpark('d7-send-0')
}"><br>


AJAX flash
	
<input type="button" value="a4-send-0" onClick="{
    sendToSpark('a4-send-0')
}">	
<input type="button" value="a4-send-45"onClick="{
    sendToSpark('a4-send-45')
}">
<input type="button" value="a4-send-90" onClick="{
    sendToSpark('a4-send-90')
}">
<input type="button" value="a4-send-180"onClick="{
    sendToSpark('a4-send-180')
}">
	
	
	
	
<input type="button" value="a5-send-0"onClick="{
    sendToSpark('a5-send-0')
}">	
<input type="button" value="a5-send-45"onClick="{
    sendToSpark('a5-send-45')
}">	
<input type="button" value="a5-send-90"onClick="{
    sendToSpark('a5-send-90')
}">	

<input type="button" value="a5-send-180"onClick="{
    sendToSpark('a5-send-180')
}"><br>


Photon	FLEX SERVO Flash
	

<input type="button" value="a4-180"onClick="{
    sendToSpark('a4-serv-180')
}">   
<input type="button" value="a4-(-180)"onClick="{
    sendToSpark('a4-serv--180')
}">	
<input type="button" value="a4-180"onClick="{
    sendToSpark('a4-serv-180')
}">
<input type="button" value="a4-90"onClick="{
    sendToSpark('a4-serv-90')
}">	
<input type="button" value="a4-0"onClick="{
    sendToSpark('a4-serv-0')
}">	
<input type="button" value="a4-45"onClick="{
    sendToSpark('a4-serv-45')
}"><br>
	
	
	
	
<input type="button" value="a5-90"onClick="{
    sendToSpark('a5-ser5-90')
}">
<input type="button" value="a5-(-90)"onClick="{
    sendToSpark('a5-ser5--90')
}">
<input type="button" value="a5-180"onClick="{
    sendToSpark('a5-ser5-180')
}">
<input type="button" value="a5-(-180)"onClick="{
    sendToSpark('a5-ser5--180')
}">
<br><br>
  
  <label for="tilt">tilt:</label>
  <input type="range" name="tilt"  value="90" min="0" max="180" data-popup-enabled="true">
    

  <label for="pan">Pan:</label>
  <input type="range" name="pan"  value="90" min="0" list="myData"max="180" onChange="setValue(this)">
 <datalist id="myData">
       <option value="0">
       <option value="45">
       <option value="60">
       <option value="90">
       <option value="120">
       <option value="150">
       <option value="180">
    </datalist>



   
   
   
   <!DOCTYPE HTML>
<html>
  <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<body>
    <P>Set Servo Position:<br><br>
    <input type="range" name="degBox" id="degBoxId" min="0" max="180" step="1" value="90"  onchange="setValue(this)">
    <!-- This adds the tick marks to the range but does not in Safari -->
    <datalist id="myData">
       <option value="0">
       <option value="30">
       <option value="60">
       <option value="90">
       <option value="120">
       <option value="150">
       <option value="180">
    </datalist>
    <br><br>
    <button id="minusbutton" onclick="fineAdjust(-5)">&lArr; -5 &deg;</button>
    <button id="plusbutton"  onclick="fineAdjust(+5)">+5 &deg; &rArr;</button>
    <br><br>
    <P>Current Position: <span id="curPos"></span><br>

    <script type="text/javascript">
      var deviceID    = "<< 310027000447343337373738 >>";
      var accessToken = "<< bb2dddc5ab7cc36ce97d1199d99156e782c9942f >>";
      var setFunc = "setpos";
      var getFunc = "getpos";

      window.setInterval(function() {
        requestURL = "https://api.spark.io/v1/devices/" + deviceID + "/" + getFunc + "/?access_token=" + accessToken;
        $.getJSON(requestURL, function(json) {
                 document.getElementById("curPos").innerHTML = json.result + "&deg;";
                 document.getElementById("curPos").style.fontSize = "28px";
                 document.getElementById("degBoxId").value = parseInt(json.result);
                 });
      }, 1000);

      function setValue(obj) {
        var newValue = document.getElementById('degBoxId').value;
        sparkSetPos(newValue);
      }
      
      function fineAdjust(value) {
        var currentValue = parseInt(document.getElementById('curPos').innerHTML);
        var setValue = value + currentValue;
        sparkSetPos(setValue);
        document.getElementById("degBoxId").value = setValue;
      }

      function sparkSetPos(newValue) {
	var requestURL = "https://api.spark.io/v1/devices/" +deviceID + "/" + setFunc + "/";
        $.post( requestURL, { params: newValue, access_token: accessToken });
      }

    </script>

          
          
          
          
          
          
          sparkSetPos(newValue) {
	var requestURL = "https://api.spark.io/v1/devices/" +deviceID + "/" + setFunc + "/";
        $.post( requestURL, { params: newValue, access_token: accessToken });
      }


   
   
   
   
   
   
   
   



<body onload="{
   myStorage1 = localStorage.getItem('myStoredText1')
   if(myStorage1  != null){     
      document.getElementById('myToken').value = myStorage1 
    }   
    myStorage2 = localStorage.getItem('myStoredText2')
    if(myStorage2  != null){
       document.getElementById('myDeviceId').value = myStorage2      
    }
          
}">

  







<h2 align=center>Iggys Final project<br> Phone mount </h2>



Device ID:<input id="myDeviceId" name="myCoreID" type=password size=20 placeholder="78dd12345678123456"> <br>


<input id="myFunctionName" name="myFunction"  type=hidden size=20 value="my-main" > 

<form name="myForm" method="POST" id="myCoolForm" ><br>

<input id="myParameter" name="params" type=text  style="display:none"     size=20 placeholder="d7-send-high"> 

Access Token:<input id="myToken" name="access_token" type=password size=20 placeholder="5622ce6bba702ef6bd3456d5ed26aaa4a28d7c9"> <br>




</form>



<input type="button" value="store id and token" onClick="{
   localStorage.setItem('myStoredText1', document.all.myToken.value)   
   localStorage.setItem('myStoredText2', document.all.myDeviceId.value)
   alert( document.all.myToken.value + ' ' +document.all.myDeviceId.value + ' \nHas been stored')
}">


   
   
   
   

<div width="400" height="200" name="myDivName" id="myDivId"> output here </div><br>



<input type=button id="myToVolts" value="Convert Sensor reading into Volts" onclick="{
  var myTemp = parseFloat(getElementById('myDivId').innerHTML)
  document.all.myCalc1.value = (myTemp * 3.3 / 4095).toFixed(2);
}">
: <input type=text id="myCalc1" value=0 size=5>Volts <br><br><br>











</font>
</body>
</html>
